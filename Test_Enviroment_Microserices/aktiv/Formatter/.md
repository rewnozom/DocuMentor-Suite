# extractor.py

- Extrahera grundläggande kompatibilitetsinformation med hjälp av två uppsättningar mönster (grundläggande och alternativa).
- Skapa produktreferenser utifrån textutdrag.
- Extrahera ersättningsrelationer.
- Berika relationerna med tekniska krav, villkor och certifieringsinformation.
- Extrahera produktfamilj och lägga till familjerelaterad kompatibilitet.
- Validera varje relation och beräkna en slutgiltig konfidensnivå.


"""
extractor.py – Extraherar kompatibilitetsinformation från dokumenttext

Denna modul kombinerar en modern pattern-baserad extraktion med ursprunglig logik för att
extrahera:
  • Grundläggande kompatibilitetsrelationer med hjälp av BASIC och alternativa regex.
  • Ersättningsrelationer.
  • Teknisk information och villkor som berikar varje relation.
  • Produktfamiljsinformation och applicerar familjerelaterad kompatibilitet.
  • Slutgiltig konfidensberäkning och validering av extraherade relationer.

Alla fel hanteras genom anpassade undantag (ExtractionError).
"""

### Sammanfattande beskrivning

- **CompatibilityExtractor**  
  - **Huvudansvar:** Extrahera kompatibilitetsrelationer från dokumenttext baserat på definierade regex‑mönster.
  - **Metoder:**
    - **extract:** Huvudmetoden som tar dokumentinnehåll och sektioner (samt eventuellt filväg) och returnerar en lista med kompatibilitetsrelationer.
    - **_get_basic_patterns & _get_alternative_patterns:** Returnerar listor med regex‑mönster för att extrahera relationer.
    - **_determine_relation_type:** Bestämmer relationstypen (DIRECT, REQUIRES, REPLACES, REPLACED_BY, ACCESSORY) baserat på textinnehåll.
    - **_extract_context:** Hämtar en kontextsträng runt en matchning för att ge bättre förståelse.
    - **_create_product_reference:** Skapar en produktreferens utifrån ett textutdrag genom att extrahera artikelnummer, serie och variant.
    - **_get_source_product:** Hämtar källproduktinformation från dokumentets början eller filnamn.
    - **_extract_replacements:** Extraherar ersättningsrelationer med hjälp av ersättningsmönster.
    - **_extract_product_family:** Extraherar produktfamiljsinformation från innehållet.
    - **_enrich_relations_with_requirements:** Lägger till tekniska krav, villkor och certifieringar till extraherade relationer.
    - **_extract_technical_requirements, _extract_conditions, _extract_certification:** Metoder som extraherar detaljerade tekniska attribut och villkor.
    - **_calculate_confidence & _assess_context_quality:** Beräknar en slutlig konfidensnivå för varje relation baserat på innehåll och kontext.
    - **_validate_relation:** Säkerställer att varje extraherad relation är komplett och logiskt korrekt.
    - **_add_family_compatibility:** Lägger till familjerelaterade kompatibilitetsrelationer baserat på extraherad produktfamilj.

Med denna modul får du en central plats för att hantera all extraktion av kompatibilitetsinformation, vilket gör vidare underhåll och utveckling enklare.
